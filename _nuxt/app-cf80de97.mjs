import{d as b,_ as w}from"./RecordingButton-bdcc7198.mjs";import x from"./ShowStatsButton-34fdb4a3.mjs";import A from"./ContainerUi-a2abf057.mjs";import N from"./OperationHistoryPanel-3f69b482.mjs";import{k as P,a as F,Q as K,b as J,r as U,a8 as R,G as V,o as $,f as B,h as y,i as s,u as g,I as H,a7 as M}from"./entry-746bcc5f.mjs";import{a as D,u as L}from"./useTimeline-26c79925.mjs";import{u as q}from"./useOperation-1812d4cf.mjs";import{u as z}from"./useKeyboard-f89a0fa8.mjs";import{u as Y}from"./useUpdate-2c1dbfb4.mjs";import{u as G,i as S,_ as Q,a as W}from"./ProjectModal-00dca420.mjs";import X from"./ButtonMenu-1b8bf222.mjs";import Z from"./SettingsButton-80de724d.mjs";import{c as u}from"./clone-0e5b969a.mjs";import{g as ee}from"./getIsElectron-dd460f76.mjs";import"./Recorder-05bef03b.mjs";import"./RecordingModal-3b2b15fa.mjs";import"./VButton-caa0163a.mjs";import"./VModal-80391bea.mjs";import"./VIcons-740bdfe0.mjs";import"./mdi-646f06ee.mjs";import"./PanelUi-e4178c0c.mjs";import"./useDragAndDrop-792de93d.mjs";import"./ResizeTop-2469f47c.mjs";import"./ResizeLeft-b68c6b46.mjs";import"./onDragStart-b67a33ef.mjs";import"./RectUi-7e7f9aee.mjs";import"./SettingsModal-db8f159e.mjs";import"./VNumberInput-f70171ea.mjs";import"./VInputBase-0ac822ab.mjs";function te(_){const t=document.createElement("input");t.type="file",t.accept=".json",t.click(),t.onchange=()=>{if(!t.files)return;const i=t.files[0];if(!i)return;const n=new FileReader;n.onload=()=>{typeof n.result=="string"&&_(n.result)},n.readAsText(i)}}function oe(){return navigator.platform.toUpperCase().includes("MAC")}const ne={style:{height:"calc(100vh - 48px)"}},se={class:"header-menu"},ie=F({__name:"app",setup(_){const{container:t}=K(),{init:i,timeline:n}=D(),{assets:f}=L(),C=q(),{init:k}=z(),{update:j}=Y(),{project:c}=G(),d=M.main,O=J(()=>t.value),v=U(!0);R({script:[{src:"/Vega/scripts/require.js"}]}),V(()=>{k();let o=0;const l=e=>{j(e-o),requestAnimationFrame(l),o=e};l(0),window.addEventListener("keydown",e=>{const a=oe()?e.metaKey:e.ctrlKey;e.keyCode===90&&e.shiftKey&&a?d.redo():e.keyCode===90&&a&&d.undo();const m=ee();e.keyCode===83&&a&&(m?c.value.path?S("SAVE_FILE",{path:c.value.path,data:p()}):S("SAVE_NEW_FILE",p()).then(r=>{if(r===!1)return;const h=JSON.parse(localStorage.getItem("RECENT_USED_PROJECT_PATHS_KEY")||"[]");h.push(r),localStorage.setItem("RECENT_USED_PROJECT_PATHS_KEY",JSON.stringify(h)),c.value={assets:u(f.value),container:u(t.value),timeline:u(n.value),path:r}}):E(),C.pushHistory("Save"),e.preventDefault())}),i()});function E(){const o=p();b(o,"project.json")}function p(){const o={container:t.value,timeline:n.value,assets:f.value};return JSON.stringify(o)}function T(){v.value=!1,i()}const I=()=>{te(o=>{W(o)})};return(o,l)=>{const e=w,a=x,m=A,r=N;return $(),B("div",{class:"root text-white bg-background1",style:H({display:g(t).align==="horizontal"?"flex":"block"})},[y("div",ne,[y("div",se,[s(e),s(X,{label:"File",items:[{name:"Open",onClick:I},{name:"Save",onClick:E}]},null,8,["items"]),s(Z),s(a)]),s(m,{container:g(O)},null,8,["container"]),s(r)]),s(Q,{"is-open":v.value,onOpen:T},null,8,["is-open"])],4)}}});var Ke=P(ie,[["__scopeId","data-v-3e6cf163"]]);export{Ke as default};
